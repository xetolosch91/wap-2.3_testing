name: XML Formatting Check

# Trigger on all pull requests and optionally on all pushes
on:
  pull_request:
    branches: ["*"]
  push:
    branches: ["*"]

jobs:
  check-xml:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Install XML tools
        run: |
          sudo apt-get update
          sudo apt-get install -y xmlstarlet

      - name: Validate XML files
        run: |
          echo "üîç Checking XML formatting..."
          STATUS=0

          # Find all XML files
          while IFS= read -r -d '' file; do
            echo "‚Üí Checking $file"

            # Validate XML strictly
            if ! xmlstarlet val -e "$file"; then
              echo "‚ùå XML syntax error in $file"
              STATUS=1
            fi
          done < <(find . -type f -name "*.xml" -print0)

          exit $STATUS